{# Frontend/templates/calculators/house_affordability.html #}
{% extends "base.html" %}
{% block title %}House Affordability{% endblock %}

{% block content %}

<h1 class="text-2xl font-bold mb-4">House Affordability Calculator</h1>

<form 
    method="POST"
    hx-post="{{ url_for('calculators.house_affordability') }}"
    hx-target="#results"
    hx-swap="innerHTML"
    class="space-y-4 max-w-lg"
>

    <!-- REQUIRED FIELDS -->
    <div class="space-y-4">
        <div>
            <label class="block font-semibold">Annual Gross Household Income *</label>
            <input name="income" type="text" class="input" required>
            {% if errors.income %}<p class="text-red-500 text-sm">{{ errors.income }}</p>{% endif %}
        </div>

        <div>
            <label class="block font-semibold">Down Payment *</label>
            <input name="down_payment" type="text" class="input" required>
            {% if errors.down_payment %}<p class="text-red-500 text-sm">{{ errors.down_payment }}</p>{% endif %}
        </div>

        <div>
            <label class="block font-semibold">Interest Rate (%) *</label>
            <input name="interest_rate" type="text" class="input" required>
            {% if errors.interest_rate %}<p class="text-red-500 text-sm">{{ errors.interest_rate }}</p>{% endif %}
        </div>

        <div>
            <label class="block font-semibold">Loan Term (years) *</label>
            <input name="loan_term" type="text" class="input" required>
            {% if errors.loan_term %}<p class="text-red-500 text-sm">{{ errors.loan_term }}</p>{% endif %}
        </div>
    </div>

    <!-- ADVANCED TOGGLE -->
    <input type="hidden" id="advanced-state" name="advanced_state" value="0">

    <button
        type="button"
        class="mt-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded"
        hx-get="{{ url_for('calculators.house_affordability') }}"
        hx-vals='js:{"show": document.getElementById("advanced-state").value === "0" ? "1" : "0"}'
        hx-target="#advanced-fields"
        hx-swap="innerHTML"
        hx-on::after-request="document.getElementById('advanced-state').value = document.getElementById('advanced-state').value === '0' ? '1' : '0';"
    >
        Advanced Options
    </button>

    <!-- ADVANCED FIELDS (HTMX loads here) -->
    <div id="advanced-fields" class="mt-4"></div>

    <button class="mt-6 px-4 py-2 bg-blue-600 text-white rounded">
        Calculate
    </button>
</form>

<!-- RESULTS -->
<div id="results" class="mt-8">
    {% if result %}
        {% include "calculators/_house_affordability_results.html" %}
    {% endif %}
</div>

{% endblock %}
